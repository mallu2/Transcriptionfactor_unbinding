# Activate MOLINFO functionalities
MOLINFO STRUCTURE=1osl_C52V_GMX_new_numbering.pdb MOLTYPE=protein
# alphaRMSD
alpha: ALPHARMSD RESIDUES=87-93,149-155 
# Define the area you want to analyse
Protein_COM: COM ATOMS=1145-3076 # not used, DBD plus part of core
DNA_center: COM ATOMS=255-257,287-289,827-829,859-861 # P and OP of central two basepairs 
# Define the distance between the hinges and the DNA center
hingeA: COM ATOMS=1923,1925,1945-1947,1949,1962-1963,1965,1971-1973,1975,1988-1990,1992,2005,2007,2009,2024,2026,2028,2041,2042 # hinge backbone atoms (N,C,O,CA)
hingeB: COM ATOMS=2887,2889,2909,2911,2913,2925,2927,2929,2935,2937,2939,2952,2954,2956,2969,2971,2973,2988,2990,2992,2998,2999 # hinge backbone atoms (N,C,O,CA)
distA: DISTANCE ATOMS=hingeA,DNA_center
distB: DISTANCE ATOMS=hingeB,DNA_center
distH: DISTANCE ATOMS=hingeA,hingeB

# define the DNA bending vector
p1_l: COM ATOMS=1-28,1111-1144 # first (fourth) bp
p1_r: COM ATOMS=539-600 # last (21st) bp
DNA_bent: ANGLE ATOMS=p1_l,DNA_center,p1_r

# check for native contacts
CONTACTMAP ...
ATOMS1=1238,937 SWITCH1={RATIONAL R_0=0.3 D_0=0.5230 }
ATOMS2=1261,905 SWITCH2={RATIONAL R_0=0.3 D_0=0.4182 }
ATOMS3=1400,903 SWITCH3={RATIONAL R_0=0.3 D_0=0.3135 }
ATOMS4=1419,175 SWITCH4={RATIONAL R_0=0.3 D_0=0.2687 }
ATOMS5=1462,937 SWITCH5={RATIONAL R_0=0.3 D_0=0.4656 }
ATOMS6=1485,144 SWITCH6={RATIONAL R_0=0.3 D_0=0.3112 }
ATOMS7=1578,41 SWITCH7={RATIONAL R_0=0.3 D_0=0.4396 }
ATOMS8=2199,331 SWITCH8={RATIONAL R_0=0.3 D_0=0.4943 }
ATOMS9=2227,333 SWITCH9={RATIONAL R_0=0.3 D_0=0.3835 }
ATOMS10=2368,365 SWITCH10={RATIONAL R_0=0.3 D_0=0.2899 }
ATOMS11=2386,401 SWITCH11={RATIONAL R_0=0.3 D_0=0.2666 }
ATOMS12=2428,365 SWITCH12={RATIONAL R_0=0.3 D_0=0.4717 }
ATOMS13=2451,648 SWITCH13={RATIONAL R_0=0.3 D_0=0.2917 }
ATOMS14=2544,613 SWITCH14={RATIONAL R_0=0.3 D_0=0.4913 }
ATOMS15=1944,2917 SWITCH15={RATIONAL R_0=0.3 D_0=0.5311 }
ATOMS16=1960,2917 SWITCH16={RATIONAL R_0=0.3 D_0=0.3087 }
ATOMS17=1965,2980 SWITCH17={RATIONAL R_0=0.3 D_0=0.3807 }
ATOMS18=1986,2917 SWITCH18={RATIONAL R_0=0.3 D_0=0.6346 }
ATOMS19=1999,2921 SWITCH19={RATIONAL R_0=0.3 D_0=0.3000 }
ATOMS20=2018,2984 SWITCH20={RATIONAL R_0=0.3 D_0=0.3287 }
ATOMS21=2024,2984 SWITCH21={RATIONAL R_0=0.3 D_0=0.6335 }
LABEL=cmap
SUM
... CONTACTMAP

# check for native contacts, hinge
CONTACTMAP ...
ATOMS1=1944,2917 SWITCH1={RATIONAL R_0=0.3 D_0=0.5311 }
ATOMS2=1960,2917 SWITCH2={RATIONAL R_0=0.3 D_0=0.3087 }
ATOMS3=1965,2980 SWITCH3={RATIONAL R_0=0.3 D_0=0.3807 }
ATOMS4=1986,2917 SWITCH4={RATIONAL R_0=0.3 D_0=0.6346 }
ATOMS5=1999,2921 SWITCH5={RATIONAL R_0=0.3 D_0=0.3000 }
ATOMS6=2018,2984 SWITCH6={RATIONAL R_0=0.3 D_0=0.3287 }
ATOMS7=2024,2984 SWITCH7={RATIONAL R_0=0.3 D_0=0.6335 }
LABEL=cmap_hinge
SUM
... CONTACTMAP

# check for native contacts, DNA
CONTACTMAP ...
ATOMS1=1238,937 SWITCH1={RATIONAL R_0=0.3 D_0=0.5230 }
ATOMS2=1261,905 SWITCH2={RATIONAL R_0=0.3 D_0=0.4182 }
ATOMS3=1400,903 SWITCH3={RATIONAL R_0=0.3 D_0=0.3135 }
ATOMS4=1419,175 SWITCH4={RATIONAL R_0=0.3 D_0=0.2687 }
ATOMS5=1462,937 SWITCH5={RATIONAL R_0=0.3 D_0=0.4656 }
ATOMS6=1485,144 SWITCH6={RATIONAL R_0=0.3 D_0=0.3112 }
ATOMS7=1578,41 SWITCH7={RATIONAL R_0=0.3 D_0=0.4396 }
ATOMS8=2199,331 SWITCH8={RATIONAL R_0=0.3 D_0=0.4943 }
ATOMS9=2227,333 SWITCH9={RATIONAL R_0=0.3 D_0=0.3835 }
ATOMS10=2368,365 SWITCH10={RATIONAL R_0=0.3 D_0=0.2899 }
ATOMS11=2386,401 SWITCH11={RATIONAL R_0=0.3 D_0=0.2666 }
ATOMS12=2428,365 SWITCH12={RATIONAL R_0=0.3 D_0=0.4717 }
ATOMS13=2451,648 SWITCH13={RATIONAL R_0=0.3 D_0=0.2917 }
ATOMS14=2544,613 SWITCH14={RATIONAL R_0=0.3 D_0=0.4913 }
LABEL=cmap_DNA
SUM
... CONTACTMAP
# Print both collective variables on CVs file
PRINT ARG=cmap,alpha,DNA_bent,distH,distA,distB,cmap_DNA,cmap_hinge FILE=CVs STRIDE=1
