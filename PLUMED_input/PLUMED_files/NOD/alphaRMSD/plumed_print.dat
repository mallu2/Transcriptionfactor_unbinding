# Activate MOLINFO functionalities
MOLINFO STRUCTURE=1efa_NOD_S99_mod_ID.pdb MOLTYPE=protein
# alphaRMSD
alpha: ALPHARMSD RESIDUES=50-56,385-391   
# Define the area you want to analyse
Protein_COM: COM ATOMS=1-1648,5086-6733 # not used, DBD plus part of core
DNA_center: COM ATOMS=10520-10522,10553-10555,11284-11286,11316-11318 # P and OP of central two basepairs 
# Define the distance between the hinges and the DNA center
hingeA: COM ATOMS=760,762,782-784,786,799-800,802,808-810,812,825-827,829,842-844,846,861-863,865,878-879 # hinge backbone atoms (N,C,O,CA)
hingeB: COM ATOMS=5845,5847,5867-5869,5871,5883-5885,5887,5893-5895,5897,5910-5912,5914,5927-5929,5931,5946-5948,5950,5956-5957 # hinge backbone atoms (N,C,O,CA)
distA: DISTANCE ATOMS=hingeA,DNA_center
distB: DISTANCE ATOMS=hingeB,DNA_center
distH: DISTANCE ATOMS=hingeA,hingeB

# define the DNA bending vector
p1_l: COM ATOMS=10262-10294,11568-11597
p1_r: COM ATOMS=10807-10839,11029-11058
DNA_bent: ANGLE ATOMS=p1_l,DNA_center,p1_r

# check for native contacts
CONTACTMAP ...
ATOMS1=82,10598 SWITCH1={RATIONAL R_0=0.3 D_0=0.5230 }
ATOMS2=101,10603 SWITCH2={RATIONAL R_0=0.3 D_0=0.4182 }
ATOMS3=240,11203 SWITCH3={RATIONAL R_0=0.3 D_0=0.3135 }
ATOMS4=260,10670 SWITCH4={RATIONAL R_0=0.3 D_0=0.2687 }
ATOMS5=302,10630 SWITCH5={RATIONAL R_0=0.3 D_0=0.4656 }
ATOMS6=325,11106 SWITCH6={RATIONAL R_0=0.3 D_0=0.3112 }
ATOMS7=418,11074 SWITCH7={RATIONAL R_0=0.3 D_0=0.4396 }
ATOMS8=5167,11359 SWITCH8={RATIONAL R_0=0.3 D_0=0.4943 }
ATOMS9=5186,11361 SWITCH9={RATIONAL R_0=0.3 D_0=0.3835 }
ATOMS10=5325,10442 SWITCH10={RATIONAL R_0=0.3 D_0=0.2899 }
ATOMS11=5345,11431 SWITCH11={RATIONAL R_0=0.3 D_0=0.2666 }
ATOMS12=5387,11391 SWITCH12={RATIONAL R_0=0.3 D_0=0.4717 }
ATOMS13=5410,10374 SWITCH13={RATIONAL R_0=0.3 D_0=0.2917 }
ATOMS14=5516,10342 SWITCH14={RATIONAL R_0=0.3 D_0=0.4913 }
ATOMS15=783,5875 SWITCH15={RATIONAL R_0=0.3 D_0=0.5311 }
ATOMS16=799,5875 SWITCH16={RATIONAL R_0=0.3 D_0=0.3087 }
ATOMS17=804,5938 SWITCH17={RATIONAL R_0=0.3 D_0=0.3807 }
ATOMS18=825,5875 SWITCH18={RATIONAL R_0=0.3 D_0=0.6346 }
ATOMS19=838,5879 SWITCH19={RATIONAL R_0=0.3 D_0=0.3000 }
ATOMS20=857,5942 SWITCH20={RATIONAL R_0=0.3 D_0=0.3287 }
ATOMS21=863,5942 SWITCH21={RATIONAL R_0=0.3 D_0=0.6335 }
LABEL=cmap
SUM
... CONTACTMAP

# check for native contacts, hinge
CONTACTMAP ...
ATOMS1=783,5875 SWITCH1={RATIONAL R_0=0.3 D_0=0.5311 }
ATOMS2=799,5875 SWITCH2={RATIONAL R_0=0.3 D_0=0.3087 }
ATOMS3=804,5938 SWITCH3={RATIONAL R_0=0.3 D_0=0.3807 }
ATOMS4=825,5875 SWITCH4={RATIONAL R_0=0.3 D_0=0.6346 }
ATOMS5=838,5879 SWITCH5={RATIONAL R_0=0.3 D_0=0.3000 }
ATOMS6=857,5942 SWITCH6={RATIONAL R_0=0.3 D_0=0.3287 }
ATOMS7=863,5942 SWITCH7={RATIONAL R_0=0.3 D_0=0.6335 }
LABEL=cmap_hinge
SUM
... CONTACTMAP

# check for native contacts, DNA
CONTACTMAP ...
ATOMS1=82,10598 SWITCH1={RATIONAL R_0=0.3 D_0=0.5230 }
ATOMS2=101,10603 SWITCH2={RATIONAL R_0=0.3 D_0=0.4182 }
ATOMS3=240,11203 SWITCH3={RATIONAL R_0=0.3 D_0=0.3135 }
ATOMS4=260,10670 SWITCH4={RATIONAL R_0=0.3 D_0=0.2687 }
ATOMS5=302,10630 SWITCH5={RATIONAL R_0=0.3 D_0=0.4656 }
ATOMS6=325,11106 SWITCH6={RATIONAL R_0=0.3 D_0=0.3112 }
ATOMS7=418,11074 SWITCH7={RATIONAL R_0=0.3 D_0=0.4396 }
ATOMS8=5167,11359 SWITCH8={RATIONAL R_0=0.3 D_0=0.4943 }
ATOMS9=5186,11361 SWITCH9={RATIONAL R_0=0.3 D_0=0.3835 }
ATOMS10=5325,10442 SWITCH10={RATIONAL R_0=0.3 D_0=0.2899 }
ATOMS11=5345,11431 SWITCH11={RATIONAL R_0=0.3 D_0=0.2666 }
ATOMS12=5387,11391 SWITCH12={RATIONAL R_0=0.3 D_0=0.4717 }
ATOMS13=5410,10374 SWITCH13={RATIONAL R_0=0.3 D_0=0.2917 }
ATOMS14=5516,10342 SWITCH14={RATIONAL R_0=0.3 D_0=0.4913 }
LABEL=cmap_DNA
SUM
... CONTACTMAP

# Print all the contacts and check them
dist1: DISTANCE ATOMS=82,10598 
dist2: DISTANCE ATOMS=101,10603 
dist3: DISTANCE ATOMS=240,11203 
dist4: DISTANCE ATOMS=260,10670
dist5: DISTANCE ATOMS=302,10630 
dist6: DISTANCE ATOMS=325,11106
dist7: DISTANCE ATOMS=418,11074
dist8: DISTANCE ATOMS=5167,11359
dist9: DISTANCE ATOMS=5186,11361  
dist10: DISTANCE ATOMS=5325,10442 
dist11: DISTANCE ATOMS=5345,11431
dist12: DISTANCE ATOMS=5387,11391 
dist13: DISTANCE ATOMS=5410,10374 
dist14: DISTANCE ATOMS=5516,10342 
dist15: DISTANCE ATOMS=783,5875
dist16: DISTANCE ATOMS=799,5875  
dist17: DISTANCE ATOMS=804,5938 
dist18: DISTANCE ATOMS=825,5875
dist19: DISTANCE ATOMS=838,5879 
dist20: DISTANCE ATOMS=857,5942 
dist21: DISTANCE ATOMS=863,5942 


# Print both collective variables on CVs file
PRINT ARG=cmap,alpha,DNA_bent,distH,distA,distB,cmap_DNA,cmap_hinge FILE=CVs STRIDE=1
#Print individual distances to distance file
PRINT ARG=dist1,dist2,dist3,dist4,dist5,dist6,dist7,dist8,dist9,dist10,dist11,dist12,dist13,dist14,dist15,dist16,dist17,dist18,dist19,dist20,dist21 FILE=distances STRIDE=1
